# Generated by Codex on 2026-02-13

from django.conf import settings
from django.db import migrations


def seed_admin_emails(apps, schema_editor):
    AdminEmailAccess = apps.get_model("base", "AdminEmailAccess")

    emails = {"ilyin.rostislaw@gmail.com"}
    owner_email = (getattr(settings, "OWNER_EMAIL", "") or "").strip().lower()
    if owner_email:
        emails.add(owner_email)

    for email in sorted(emails):
        AdminEmailAccess.objects.update_or_create(
            email=email,
            defaults={
                "is_active": True,
                "note": "Seeded admin access",
            },
        )


class Migration(migrations.Migration):
    dependencies = [
        ("base", "0006_telegramauthcode_adminemailaccess"),
    ]

    operations = [
        migrations.RunPython(seed_admin_emails, migrations.RunPython.noop),
    ]
