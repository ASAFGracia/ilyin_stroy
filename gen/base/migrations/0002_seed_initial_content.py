# Generated by Codex on 2026-02-12

from django.db import migrations


def seed_site_and_articles(apps, schema_editor):
    Site = apps.get_model("sites", "Site")
    Article = apps.get_model("base", "Article")

    Site.objects.update_or_create(
        id=1,
        defaults={"domain": "mastersvarki.com", "name": "Mastersvarki"},
    )

    articles = [
        {
            "template_key": "walls",
            "title": "Наружные и внутренние стены",
            "slug": "outer-and-inner-walls",
            "summary": (
                "Практическая памятка по стенам: выбор материала, "
                "последовательность работ и контроль качества."
            ),
            "content": (
                "Стены отвечают не только за геометрию дома, но и за теплоэффективность, "
                "шумоизоляцию и долговечность отделки.\n\n"
                "Что учитываем перед стартом:\n"
                "1. Тип конструкции: несущая стена или перегородка.\n"
                "2. Материал: газобетон, кирпич, блок, каркас.\n"
                "3. Узлы примыканий: фундамент, перекрытие, проемы.\n\n"
                "Этапы выполнения работ:\n"
                "- Разметка и проверка диагоналей.\n"
                "- Монтаж/кладка с контролем вертикали и швов.\n"
                "- Армирование зон нагрузок.\n"
                "- Подготовка под отделку.\n\n"
                "Результат: ровные и надежные стены, готовые к финишной отделке."
            ),
            "is_published": True,
        },
        {
            "template_key": "lower_floor",
            "title": "Полы нижнего этажа",
            "slug": "lower-floor-floors",
            "summary": (
                "Основание пола, гидроизоляция и утепление: что важно сделать, "
                "чтобы не получить сырость и потери тепла."
            ),
            "content": (
                "Пол нижнего этажа должен одновременно держать нагрузку, сохранять тепло "
                "и защищать помещение от влаги.\n\n"
                "Базовый состав конструкции:\n"
                "- Подготовка основания и уплотнение.\n"
                "- Гидроизоляционный слой.\n"
                "- Утеплитель нужной плотности.\n"
                "- Черновая стяжка и подготовка под финиш.\n\n"
                "Контрольные точки:\n"
                "1. Нулевой уровень и перепады.\n"
                "2. Толщина и равномерность слоев.\n"
                "3. Сроки набора прочности стяжки.\n\n"
                "Такой подход уменьшает риск трещин и дает стабильную основу под любое покрытие."
            ),
            "is_published": True,
        },
        {
            "template_key": "drainage",
            "title": "Дренажная система и коммуникации",
            "slug": "drainage-and-communications",
            "summary": (
                "Как защитить фундамент и участок: дренаж, отвод воды, "
                "технические нюансы уклона и монтажа."
            ),
            "content": (
                "Грамотный дренаж продлевает срок службы фундамента и снижает риск "
                "подтопления участка.\n\n"
                "Что обычно входит в работы:\n"
                "- Трассировка и расчет уклонов.\n"
                "- Монтаж труб с фильтрующей обсыпкой.\n"
                "- Ревизионные точки и колодцы.\n"
                "- Организация отвода в безопасную зону.\n\n"
                "Ключевые требования:\n"
                "1. Стабильный уклон по всей длине.\n"
                "2. Качественный геотекстиль и щебеночная обсыпка.\n"
                "3. Доступность системы для обслуживания.\n\n"
                "Итог: участок и конструктив дома защищены от лишней влаги."
            ),
            "is_published": True,
        },
    ]

    for item in articles:
        Article.objects.update_or_create(
            slug=item["slug"],
            defaults=item,
        )


class Migration(migrations.Migration):
    dependencies = [
        ("sites", "0002_alter_domain_unique"),
        ("base", "0001_initial"),
    ]

    operations = [
        migrations.RunPython(seed_site_and_articles, migrations.RunPython.noop),
    ]
